<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="dao.mapper.ScrapMapper">	
	<select id="scrapComfirmSelect" resultType="Scrap" parameterType="map">
		select * from scrap where memberid=#{memberid}
		<if test="studyno != null">
			and studyno=#{studyno}
		</if>
	</select>
	<select id="hireScrapSelect" resultType="Scrap" parameterType="map">
		select * from scrap where memberid=#{memberid} and hireno=#{hireno}
	</select>
		<select id="scrapHirelist" resultType="Scrap" parameterType="map">
			select * from scrap where memberid =#{memberid} and hireno is not null
			order by scrap desc limit #{startrow}, #{limit}
		</select>
		<select id="scrapHireCount" resultType="int" parameterType="map">
			select count(*) from scrap where 1=1
		<if test="memberid != null">
			and memberid = #{memberid}
		</if>
		</select>		

	<select id="portfolioScrapConfirm" resultType="Scrap" parameterType="map">
		select * from scrap where memberid=#{loginid}
		<if test="scrapid != null">
			and scrapmember=#{scrapid}
		</if>
	</select>
	
	<select id="getScrapmembercount" resultType="int" parameterType="map">
		select count(*)	
		from user a, (select s.scrap,u.memberid,s.scrapmember as scrapmember
						from user u, scrap s
						where u.memberid = s.memberid) d
		where a.memberid = d.scrapmember
		<if test="memberid != null">
			and d.memberid=#{memberid}
		</if>
		<if test="searchType != null and searchContent != null">
			and ${searchType} like '%${searchContent}%'
		</if>
	</select>
	<select id="getScrapmemberlist" resultType="User" parameterType="map">
	select a.memberid, name, regdate, tel, membergrade, recognizecode, image as imageUrl, birth, industy, site, slogun, introduce, modifydate, address, locking, createpf
	from user a, (select s.scrap,u.memberid,s.scrapmember as scrapmember
					from user u, scrap s
					where u.memberid = s.memberid) d
		where a.memberid = d.scrapmember
		<if test="memberid != null">
			and d.memberid=#{memberid}
		</if>
		<if test="searchType != null and searchContent != null">
			and ${searchType} like '%${searchContent}%'
		</if>
		order by d.scrap desc limit #{startrow}, #{limit}
	</select>
</mapper>
